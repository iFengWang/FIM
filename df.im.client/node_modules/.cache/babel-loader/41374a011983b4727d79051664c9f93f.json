{"ast":null,"code":"import _regeneratorRuntime from\"/Users/feng/Work/Project/df/df.im/df.im.client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/feng/Work/Project/df/df.im/df.im.client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{useSocket}from\"../contexts/imSocket\";import{setIncomingCall,togglerChat}from\"./imStore\";import VideoInviteDialog from\"./VideoInviteDialog\";import{jsx as _jsx}from\"react/jsx-runtime\";function VideoInviteContainer(){var dispatch=useDispatch();var _useSocket=useSocket(),sendVideoAccept=_useSocket.sendVideoAccept,sendVideoReject=_useSocket.sendVideoReject;var incomingCall=useSelector(function(state){return state.imReducer.incomingCall;});var handleAcceptCall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(incomingCall){_context.next=2;break;}return _context.abrupt(\"return\");case 2:// 先打开聊天对话框\ndispatch(togglerChat({uid:incomingCall.from,name:incomingCall.fromName}));// 发送接受信号\nsendVideoAccept(incomingCall.from);// 清除邀请状态\ndispatch(setIncomingCall(null));case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleAcceptCall(){return _ref.apply(this,arguments);};}();var handleRejectCall=function handleRejectCall(){if(!incomingCall)return;sendVideoReject(incomingCall.from);dispatch(setIncomingCall(null));};if(!incomingCall)return null;return/*#__PURE__*/_jsx(VideoInviteDialog,{caller:incomingCall.fromName,onAccept:handleAcceptCall,onReject:handleRejectCall});}export default VideoInviteContainer;","map":{"version":3,"names":["React","useSelector","useDispatch","useSocket","setIncomingCall","togglerChat","VideoInviteDialog","VideoInviteContainer","dispatch","sendVideoAccept","sendVideoReject","incomingCall","state","imReducer","handleAcceptCall","uid","from","name","fromName","handleRejectCall"],"sources":["/Users/feng/Work/Project/df/df.im/df.im.client/src/im/VideoInviteContainer.js"],"sourcesContent":["import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useSocket } from \"../contexts/imSocket\";\nimport { setIncomingCall, togglerChat } from \"./imStore\";\nimport VideoInviteDialog from \"./VideoInviteDialog\";\n\nfunction VideoInviteContainer() {\n  const dispatch = useDispatch();\n  const { sendVideoAccept, sendVideoReject } = useSocket();\n  const incomingCall = useSelector((state) => state.imReducer.incomingCall);\n\n  const handleAcceptCall = async () => {\n    if (!incomingCall) return;\n\n    // 先打开聊天对话框\n    dispatch(\n      togglerChat({\n        uid: incomingCall.from,\n        name: incomingCall.fromName,\n      })\n    );\n\n    // 发送接受信号\n    sendVideoAccept(incomingCall.from);\n\n    // 清除邀请状态\n    dispatch(setIncomingCall(null));\n  };\n\n  const handleRejectCall = () => {\n    if (!incomingCall) return;\n    sendVideoReject(incomingCall.from);\n    dispatch(setIncomingCall(null));\n  };\n\n  if (!incomingCall) return null;\n\n  return (\n    <VideoInviteDialog\n      caller={incomingCall.fromName}\n      onAccept={handleAcceptCall}\n      onReject={handleRejectCall}\n    />\n  );\n}\n\nexport default VideoInviteContainer;\n"],"mappings":"wRAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,SAAS,KAAQ,sBAAsB,CAChD,OAASC,eAAe,CAAEC,WAAW,KAAQ,WAAW,CACxD,MAAOC,kBAAiB,KAAM,qBAAqB,CAAC,2CAEpD,QAASC,qBAAoB,EAAG,CAC9B,GAAMC,SAAQ,CAAGN,WAAW,EAAE,CAC9B,eAA6CC,SAAS,EAAE,CAAhDM,eAAe,YAAfA,eAAe,CAAEC,eAAe,YAAfA,eAAe,CACxC,GAAMC,aAAY,CAAGV,WAAW,CAAC,SAACW,KAAK,QAAKA,MAAK,CAACC,SAAS,CAACF,YAAY,GAAC,CAEzE,GAAMG,iBAAgB,4FAAG,wIAClBH,YAAY,iEAEjB;AACAH,QAAQ,CACNH,WAAW,CAAC,CACVU,GAAG,CAAEJ,YAAY,CAACK,IAAI,CACtBC,IAAI,CAAEN,YAAY,CAACO,QACrB,CAAC,CAAC,CACH,CAED;AACAT,eAAe,CAACE,YAAY,CAACK,IAAI,CAAC,CAElC;AACAR,QAAQ,CAACJ,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,sDACjC,kBAhBKU,iBAAgB,0CAgBrB,CAED,GAAMK,iBAAgB,CAAG,QAAnBA,iBAAgB,EAAS,CAC7B,GAAI,CAACR,YAAY,CAAE,OACnBD,eAAe,CAACC,YAAY,CAACK,IAAI,CAAC,CAClCR,QAAQ,CAACJ,eAAe,CAAC,IAAI,CAAC,CAAC,CACjC,CAAC,CAED,GAAI,CAACO,YAAY,CAAE,MAAO,KAAI,CAE9B,mBACE,KAAC,iBAAiB,EAChB,MAAM,CAAEA,YAAY,CAACO,QAAS,CAC9B,QAAQ,CAAEJ,gBAAiB,CAC3B,QAAQ,CAAEK,gBAAiB,EAC3B,CAEN,CAEA,cAAeZ,qBAAoB"},"metadata":{},"sourceType":"module"}